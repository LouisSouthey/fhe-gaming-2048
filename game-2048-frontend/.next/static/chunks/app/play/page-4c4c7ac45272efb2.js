(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{847:(e,t,r)=>{Promise.resolve().then(r.bind(r,8116))},8116:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var a=r(5155),l=r(2115);function s(){return[,,,,].fill(null).map(()=>[,,,,].fill(0))}function n(e){let t=[];for(let r=0;r<4;r++)for(let a=0;a<4;a++)0===e[r][a]&&t.push([r,a]);if(0===t.length)return e;let[r,a]=t[Math.floor(Math.random()*t.length)],l=e.map(e=>[...e]);return l[r][a]=.9>Math.random()?2:4,l}function d(){let e=s();return e=n(e),{grid:e=n(e),score:0,moves:0,gameOver:!1,won:!1}}function o(e){let t=s();for(let r=0;r<4;r++)for(let a=0;a<4;a++)t[a][3-r]=e[r][a];return t}function i(e){let t=s();for(let r=0;r<4;r++)for(let a=0;a<4;a++)t[3-a][r]=e[r][a];return t}var c=r(14),x=r(8839),g=r(3018),m=r.n(g);let b="".concat("FHE2048").concat("sepolia").concat("202510").concat("FHE2048Game.sol");parseInt(m().createHash("sha256").update(b).digest("hex").substring(0,8),16);let u={tileColors:{light:{0:"rgba(255, 255, 255, 0.1)",2:"rgba(20, 184, 166, 0.3)",4:"rgba(16, 185, 129, 0.4)",8:"rgba(6, 182, 212, 0.5)",16:"rgba(20, 184, 166, 0.6)",32:"rgba(16, 185, 129, 0.7)",64:"rgba(6, 182, 212, 0.8)",128:"rgba(45, 212, 191, 0.85)",256:"rgba(52, 211, 153, 0.87)",512:"rgba(34, 211, 238, 0.9)",1024:"rgba(45, 212, 191, 0.93)",2048:"rgba(16, 185, 129, 0.95)"},dark:{0:"rgba(30, 41, 59, 0.3)",2:"rgba(45, 212, 191, 0.3)",4:"rgba(52, 211, 153, 0.4)",8:"rgba(34, 211, 238, 0.5)",16:"rgba(45, 212, 191, 0.6)",32:"rgba(52, 211, 153, 0.7)",64:"rgba(34, 211, 238, 0.8)",128:"rgba(45, 212, 191, 0.85)",256:"rgba(52, 211, 153, 0.87)",512:"rgba(34, 211, 238, 0.9)",1024:"rgba(45, 212, 191, 0.93)",2048:"rgba(52, 211, 153, 0.95)"}}};function h(){let{signer:e,chainId:t,instance:r}=(0,x.U)(),{grid:s,score:g,moves:m,gameOver:b,won:h,isAnimating:p,moveUp:f,moveDown:v,moveLeft:j,moveRight:y,reset:k,isLoaded:N}=function(){let[e,t]=(0,l.useState)(null),[r,a]=(0,l.useState)(!1);(0,l.useEffect)(()=>{t(d())},[]);let s=(0,l.useCallback)(()=>{t(d())},[]),c=(0,l.useCallback)(l=>{!e||r||e.gameOver||(a(!0),t(function(e,t){let{grid:r,score:a,moves:l,won:s}=e,d=r.map(e=>[...e]),c=0;"up"===t?d=i(d):"down"===t?d=o(d):"right"===t&&(d=d.map(e=>[...e].reverse()));for(let e=0;e<4;e++){let t=function(e){let t=e.filter(e=>0!==e),r=0;for(let e=0;e<t.length-1;e++)t[e]===t[e+1]&&(t[e]*=2,r+=t[e],t[e+1]=0);for(t=t.filter(e=>0!==e);t.length<4;)t.push(0);return{row:t,score:r}}(d[e]);d[e]=t.row,c+=t.score}if("up"===t?d=o(d):"down"===t?d=i(d):"right"===t&&(d=d.map(e=>[...e].reverse())),!function(e,t){for(let r=0;r<4;r++)for(let a=0;a<4;a++)if(e[r][a]!==t[r][a])return!1;return!0}(r,d)){d=n(d),a+=c,l+=1,!s&&function(e){for(let t=0;t<4;t++)for(let r=0;r<4;r++)if(e[t][r]>=2048)return!0;return!1}(d)&&(s=!0);let e=!function(e){for(let t=0;t<4;t++)for(let r=0;r<4;r++)if(0===e[t][r])return!0;for(let t=0;t<4;t++)for(let r=0;r<3;r++)if(e[t][r]===e[t][r+1])return!0;for(let t=0;t<3;t++)for(let r=0;r<4;r++)if(e[t][r]===e[t+1][r])return!0;return!1}(d);return{grid:d,score:a,moves:l,gameOver:e,won:s}}return e}(e,l)),setTimeout(()=>a(!1),150))},[e,r]),x=(0,l.useCallback)(()=>c("up"),[c]),g=(0,l.useCallback)(()=>c("down"),[c]),m=(0,l.useCallback)(()=>c("left"),[c]),b=(0,l.useCallback)(()=>c("right"),[c]);return(0,l.useEffect)(()=>{let e=e=>{let t=e.key.toLowerCase();"arrowup"===t||"w"===t?(e.preventDefault(),x()):"arrowdown"===t||"s"===t?(e.preventDefault(),g()):"arrowleft"===t||"a"===t?(e.preventDefault(),m()):("arrowright"===t||"d"===t)&&(e.preventDefault(),b())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[x,g,m,b]),{grid:(null==e?void 0:e.grid)||[],score:(null==e?void 0:e.score)||0,moves:(null==e?void 0:e.moves)||0,gameOver:(null==e?void 0:e.gameOver)||!1,won:(null==e?void 0:e.won)||!1,isAnimating:r,moveUp:x,moveDown:g,moveLeft:m,moveRight:b,reset:s,isLoaded:null!==e}}(),{startGame:w,submitScore:C,loading:D,error:S,currentGameId:E,contractAddress:G,isReady:F,isWalletConnected:M}=(0,c.X)({instance:r,signer:e,chainId:t}),[O,_]=(0,l.useState)(!1),[A,L]=(0,l.useState)(!1),P=async()=>{if(!M)return void alert("Please connect your wallet first!");let e=await w();if(null!==e)if(L(!1),b||h){_(!0);let t=await C(e,g,m);_(!1),t&&L(!0)}else k(),alert("Game started on blockchain! Game ID: ".concat(e))},B=()=>{k(),L(!1)},H=async()=>{if(!M)return void alert("Please connect your wallet first!");if(null===E)return;_(!0);let e=await C(E,g,m);_(!1),e&&L(!0)};return N?(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-teal-50 to-cyan-50 dark:from-gray-900 dark:to-gray-800 p-4 pt-20",children:(0,a.jsxs)("div",{className:"container mx-auto max-w-6xl",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"glass rounded-lg px-6 py-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Score"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:g})]}),(0,a.jsxs)("div",{className:"glass rounded-lg px-6 py-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Moves"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:m})]})]}),G&&(0,a.jsx)("div",{className:"text-xs text-gray-500",children:null!==E?"Game #".concat(E):"No active game"})]}),!M&&(0,a.jsx)("div",{className:"glass rounded-xl p-4 mb-6 text-center bg-yellow-50/50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800",children:(0,a.jsx)("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"⚠️ Connect your wallet to submit scores on-chain"})}),S&&(0,a.jsx)("div",{className:"glass rounded-xl p-4 mb-6 text-center bg-red-50/50 dark:bg-red-900/20 border border-red-200 dark:border-red-800",children:(0,a.jsxs)("p",{className:"text-sm text-red-800 dark:text-red-200",children:["❌ ",S]})}),(0,a.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"glass rounded-2xl p-4",children:(0,a.jsx)("div",{className:"grid grid-cols-4 gap-3",style:{aspectRatio:"1"},children:s.map((e,t)=>e.map((e,r)=>(0,a.jsx)("div",{className:"rounded-lg flex items-center justify-center font-bold text-2xl transition-all duration-150",style:{background:(e=>{let t=u.tileColors.light;return t[e]||t[2048]})(e),color:e<=4?"#475569":"#F8FAFC",backdropFilter:"blur(8px)"},children:0!==e&&e},"".concat(t,"-").concat(r))))})}),(0,a.jsx)("div",{className:"glass rounded-xl p-4 mt-4",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:["Use ",(0,a.jsx)("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-xs",children:"↑ ↓ ← →"})," or ",(0,a.jsx)("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-xs",children:"W A S D"})," keys to move tiles.",(0,a.jsx)("br",{}),"Merge tiles with same numbers to reach 2048!"]})})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"glass rounded-2xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 text-center text-gray-800 dark:text-gray-200",children:"Game Controls"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsx)("div",{}),(0,a.jsx)("button",{onClick:f,disabled:p||b,className:"glass rounded-lg p-4 hover:bg-teal-100 dark:hover:bg-teal-900 transition-colors disabled:opacity-50 text-2xl",children:"↑"}),(0,a.jsx)("div",{}),(0,a.jsx)("button",{onClick:j,disabled:p||b,className:"glass rounded-lg p-4 hover:bg-teal-100 dark:hover:bg-teal-900 transition-colors disabled:opacity-50 text-2xl",children:"←"}),(0,a.jsx)("button",{onClick:B,className:"glass rounded-lg p-4 bg-gradient-to-r from-teal-500 to-cyan-500 text-black font-semibold hover:shadow-lg transition-all",children:"New Game"}),(0,a.jsx)("button",{onClick:y,disabled:p||b,className:"glass rounded-lg p-4 hover:bg-teal-100 dark:hover:bg-teal-900 transition-colors disabled:opacity-50 text-2xl",children:"→"}),(0,a.jsx)("div",{}),(0,a.jsx)("button",{onClick:v,disabled:p||b,className:"glass rounded-lg p-4 hover:bg-teal-100 dark:hover:bg-teal-900 transition-colors disabled:opacity-50 text-2xl",children:"↓"}),(0,a.jsx)("div",{})]})]}),(0,a.jsxs)("div",{className:"glass rounded-xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 text-center text-gray-800 dark:text-gray-200",children:"\uD83D\uDD10 Submit Score to Blockchain"}),M?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Current Score:"}),(0,a.jsx)("span",{className:"font-bold text-xl text-teal-600 dark:text-teal-400",children:g})]}),null!==E&&(0,a.jsxs)("div",{className:"text-xs text-center text-gray-500 bg-gray-100 dark:bg-gray-800 rounded px-3 py-2",children:["Active Blockchain Game ID: ",(0,a.jsxs)("span",{className:"font-mono font-bold",children:["#",E]})]}),(0,a.jsx)("div",{className:"flex gap-3 flex-wrap justify-center",children:null===E?(0,a.jsx)("button",{onClick:P,disabled:D,className:"flex-1 px-4 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:shadow-lg transition-all disabled:opacity-50 font-semibold text-sm",children:D?"Starting...":"\uD83C\uDFAE Start Blockchain Game"}):(0,a.jsx)("button",{onClick:H,disabled:O||A||0===g,className:"flex-1 px-4 py-3 bg-gradient-to-r from-teal-500 to-cyan-500 text-white rounded-lg hover:shadow-lg transition-all disabled:opacity-50 font-semibold text-sm relative overflow-hidden",children:O?(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("span",{className:"inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Submitting..."]}):A?"✓ Submitted!":"\uD83D\uDD12 Submit (".concat(g,")")})}),A&&(0,a.jsx)("div",{className:"text-center text-xs text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20 rounded px-2 py-2",children:"✅ Score submitted to blockchain!"}),0===g&&null!==E&&(0,a.jsx)("div",{className:"text-center text-xs text-gray-500",children:"Play the game to earn a score"})]}):(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"⚠️ Connect your wallet to submit scores"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Your score will be encrypted and stored securely using FHEVM"})]})]})]})]}),(b||h)&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"glass rounded-2xl p-8 max-w-md w-full text-center animate-scale-in bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/40 dark:to-pink-900/40 border-2 border-purple-200 dark:border-purple-800 shadow-2xl",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:h?"\uD83C\uDF89":"\uD83D\uDCAB"}),(0,a.jsx)("h2",{className:"text-3xl font-bold mb-2",children:h?"Congratulations!":"Game Over"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:h?"You reached 2048!":"No more moves available"})]}),(0,a.jsxs)("div",{className:"mb-6 p-6 glass rounded-xl",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Final Score"}),(0,a.jsx)("div",{className:"text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-teal-500 to-cyan-500 mb-2",children:g}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Moves: ",m]})]}),M&&(0,a.jsx)("div",{className:"mb-6",children:A?(0,a.jsxs)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"✅"}),(0,a.jsx)("p",{className:"text-sm font-semibold text-green-800 dark:text-green-200",children:"Score Submitted!"}),(0,a.jsx)("p",{className:"text-xs text-green-600 dark:text-green-300 mt-1",children:"Your encrypted score is now on the blockchain"})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:"\uD83D\uDD10 Save your score on blockchain"})}),null===E?(0,a.jsx)("button",{onClick:P,disabled:D,className:"w-full px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:shadow-lg transition-all disabled:opacity-50 font-semibold",children:D?"Starting...":"\uD83C\uDFAE Start Blockchain Game & Submit"}):(0,a.jsx)("button",{onClick:H,disabled:O,className:"w-full px-6 py-3 bg-gradient-to-r from-teal-500 to-cyan-500 text-white rounded-lg hover:shadow-lg transition-all disabled:opacity-50 font-semibold",children:O?(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("span",{className:"inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Submitting..."]}):"\uD83D\uDD12 Submit Score (".concat(g,")")})]})}),(0,a.jsx)("div",{className:"flex gap-3",children:(0,a.jsx)("button",{onClick:B,className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:shadow-xl transition-all font-semibold",children:"\uD83C\uDFAE Play Again"})})]})})]})}):(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-teal-50 to-cyan-50 dark:from-gray-900 dark:to-gray-800 p-4 pt-20",children:(0,a.jsx)("div",{className:"container mx-auto max-w-2xl",children:(0,a.jsx)("div",{className:"glass rounded-lg p-8 text-center",children:(0,a.jsx)("div",{className:"text-xl text-slate-600 dark:text-slate-400",children:"Loading game..."})})})})}}},e=>{e.O(0,[268,12,607,456,441,255,358],()=>e(e.s=847)),_N_E=e.O()}]);