(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[266],{2722:(e,t,r)=>{Promise.resolve().then(r.bind(r,4946))},4946:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(5155),a=r(8839),l=r(14),n=r(2115);function d(){let{signer:e,chainId:t,instance:r}=(0,a.U)(),{isReady:d,isWalletConnected:i,getPlayerStats:c,getGameSession:o,decryptValue:x}=(0,l.X)({instance:r,signer:e,chainId:t}),[m,u]=(0,n.useState)(null),[g,y]=(0,n.useState)([]),[h,p]=(0,n.useState)(null),[b,v]=(0,n.useState)(null),[j,N]=(0,n.useState)(!1),[f,k]=(0,n.useState)(!1),[w,D]=(0,n.useState)(null),[S,E]=(0,n.useState)({}),[C,_]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{if(!i||!e||!c){u(null),y([]),p(null);return}try{k(!0);let t=await e.getAddress(),r=await c(t);r&&(u(r.gamesPlayed),y(r.gameIds),p(r.bestScore),console.log("Player stats:",r))}catch(e){console.error("Failed to fetch player stats:",e),u(0),y([]),p(null)}finally{k(!1)}})()},[i,e,c]);let F=async()=>{if(!r||!e||!h||!x)return void D("Missing required components for decryption");N(!0),D(null);try{console.log("\uD83D\uDD13 Starting decryption of best score...",{encryptedBestScore:h.toString()});let e=await x(h);null!==e?(v(e),console.log("✅ Decryption successful:",e)):D("Decryption returned null")}catch(e){D(e instanceof Error?e.message:"Failed to decrypt best score"),console.error("❌ Decryption error:",e)}finally{N(!1)}},P=async e=>{if(!o||!x)return void alert("Decryption not available");let t=e.toString();_(t);try{console.log("\uD83D\uDD13 Decrypting game #".concat(t,"..."));let r=await o(e);if(!r)throw Error("Failed to get game session");console.log("\uD83D\uDCE6 Got encrypted game data:",{score:r.score.toString(),moves:r.moves.toString()});let[s,a]=await Promise.all([x(r.score),x(r.moves)]);if(null===s||null===a)throw Error("Decryption returned null");let l=null;try{let e=await x(r.won);l=1===e}catch(e){console.warn("Could not decrypt won status:",e)}console.log("✅ Game #".concat(t," decrypted:"),{score:s,moves:a,won:l}),E(e=>({...e,[t]:{score:s,moves:a,won:l}}))}catch(r){let e=r instanceof Error?r.message:"Decryption failed";console.error("❌ Failed to decrypt game #".concat(t,":"),r),alert("Failed to decrypt game: ".concat(e))}finally{_(null)}};return(0,s.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-teal-50 to-cyan-50 dark:from-gray-900 dark:to-gray-800 p-4 pt-24",children:(0,s.jsxs)("div",{className:"container mx-auto max-w-4xl",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-8 text-center text-teal-600 dark:text-teal-400",children:"My Statistics"}),i?f?(0,s.jsxs)("div",{className:"glass rounded-xl p-8 text-center",children:[(0,s.jsx)("div",{className:"inline-block w-8 h-8 border-4 border-teal-500 border-t-transparent rounded-full animate-spin mb-4"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading your statistics..."})]}):(0,s.jsxs)("div",{className:"grid gap-6",children:[(0,s.jsxs)("div",{className:"glass rounded-xl p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200",children:"Games Played"}),(0,s.jsx)("div",{className:"text-4xl font-bold text-teal-600 dark:text-teal-400",children:null!==m?m:"0"}),0===m&&(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Start your first blockchain game to see stats here!"})]}),(0,s.jsxs)("div",{className:"glass rounded-xl p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200",children:"Best Score (Encrypted)"}),h&&h>BigInt(0)?(0,s.jsx)("div",{children:null!==b?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-4xl font-bold text-cyan-600 dark:text-cyan-400 mb-2",children:b}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[(0,s.jsx)("span",{children:"✅"}),(0,s.jsx)("span",{children:"Successfully decrypted!"})]}),(0,s.jsx)("button",{onClick:()=>v(null),className:"mt-4 text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"\uD83D\uDD12 Hide decrypted value"})]}):(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg mb-4",children:[(0,s.jsx)("div",{className:"text-sm text-purple-800 dark:text-purple-200 mb-1",children:"\uD83D\uDD12 Encrypted on-chain"}),(0,s.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 font-mono break-all",children:["Handle: ",h.toString()]})]}),w&&(0,s.jsx)("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg mb-4",children:(0,s.jsxs)("div",{className:"text-sm text-red-800 dark:text-red-200",children:["⚠️ ",w]})}),(0,s.jsx)("button",{onClick:F,disabled:j||!d,className:"w-full px-6 py-3 bg-gradient-to-r from-teal-500 to-cyan-500 text-white rounded-lg hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed font-semibold",children:j?(0,s.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)("span",{className:"inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Decrypting..."]}):d?"\uD83D\uDD13 Decrypt Best Score":"⏳ Initializing FHEVM..."}),(0,s.jsx)("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,s.jsxs)("div",{className:"text-xs text-blue-800 dark:text-blue-200",children:["\uD83D\uDCA1 ",(0,s.jsx)("strong",{children:"Note:"})," Decryption requires signing a message with your wallet. This signature is used to prove you have permission to decrypt your own data."]})})]})}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"\uD83C\uDFAE"}),(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"No games completed yet"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Submit a score to see your encrypted best score here"})]})]}),(0,s.jsxs)("div",{className:"glass rounded-xl p-6 bg-teal-50/50 dark:bg-teal-900/20 border border-teal-200 dark:border-teal-800",children:[(0,s.jsx)("h3",{className:"font-semibold text-teal-800 dark:text-teal-200 mb-2",children:"\uD83D\uDD12 Privacy Notice"}),(0,s.jsx)("p",{className:"text-sm text-teal-700 dark:text-teal-300",children:"Your best score is stored encrypted on-chain using FHEVM. Only you can decrypt and view your actual score. Other players cannot see your individual scores, ensuring complete privacy while still allowing global statistics."})]}),(0,s.jsxs)("div",{className:"glass rounded-xl p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200",children:"Recent Games"}),g.length>0?(0,s.jsxs)("div",{className:"space-y-3",children:[g.slice().reverse().slice(0,10).map((e,t)=>{let r=e.toString(),a=S[r],l=C===r;return(0,s.jsx)("div",{className:"p-4 bg-white/50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Game #",r]}),(0,s.jsx)("span",{className:"px-2 py-0.5 bg-teal-100 dark:bg-teal-900/30 text-teal-700 dark:text-teal-300 rounded text-xs font-medium",children:"Completed"}),(null==a?void 0:a.won)&&(0,s.jsx)("span",{className:"px-2 py-0.5 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 rounded text-xs font-medium",children:"\uD83C\uDFC6 Won"})]}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:0===t?"Most recent":"".concat(t+1," games ago")}),a?(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"bg-teal-50 dark:bg-teal-900/20 rounded-lg p-2",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Score"}),(0,s.jsx)("div",{className:"text-lg font-bold text-teal-600 dark:text-teal-400",children:a.score})]}),(0,s.jsxs)("div",{className:"bg-cyan-50 dark:bg-cyan-900/20 rounded-lg p-2",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Moves"}),(0,s.jsx)("div",{className:"text-lg font-bold text-cyan-600 dark:text-cyan-400",children:a.moves})]})]}):(0,s.jsx)("div",{className:"mt-3 text-xs text-gray-500 dark:text-gray-400",children:"\uD83D\uDD12 Encrypted on-chain"})]}),!a&&(0,s.jsx)("button",{onClick:()=>P(e),disabled:l||!d,className:"px-4 py-2 bg-gradient-to-r from-teal-500 to-cyan-500 text-white rounded-lg hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:l?(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"inline-block w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Decrypting..."]}):"\uD83D\uDD13 Decrypt"})]})},r)}),g.length>10&&(0,s.jsxs)("div",{className:"text-center text-sm text-gray-500 mt-4",children:["Showing latest 10 of ",g.length," games"]})]}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"\uD83C\uDFAE"}),(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"No games played yet"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Start a blockchain game to see your history here"})]})]})]}):(0,s.jsx)("div",{className:"glass rounded-xl p-8 text-center",children:(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"⚠️ Please connect your wallet to view your statistics"})})]})})}},5378:(e,t,r)=>{"use strict";r.d(t,{_:()=>a});var s=r(6994);function a(e,t,r){var a=(0,s._)(e,t,"set");if(a.set)a.set.call(e,r);else{if(!a.writable)throw TypeError("attempted to set read only private field");a.value=r}return r}},5777:(e,t,r)=>{"use strict";function s(e,t,r){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object");t.set(e,r)}r.d(t,{_:()=>s})},6994:(e,t,r)=>{"use strict";function s(e,t,r){if(!t.has(e))throw TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}r.d(t,{_:()=>s})},7325:(e,t,r)=>{"use strict";r.d(t,{_:()=>a});var s=r(6994);function a(e,t){var r=(0,s._)(e,t,"get");return r.get?r.get.call(e):r.value}}},e=>{e.O(0,[12,456,441,255,358],()=>e(e.s=2722)),_N_E=e.O()}]);